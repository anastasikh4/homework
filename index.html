<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sound Craft: NG & CK</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --mc-green: #5aa730;
            --mc-dirt: #795548;
            --mc-stone: #4e4e4e;
            --mc-sky: #7293ff;
            --mc-border: #212121;
            --font-main: 'Comic Neue', sans-serif;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--mc-sky);
            background-image: linear-gradient(to bottom, #7293ff, #ffffff);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: white;
        }

        h1 { font-size: 3.5rem; margin: 20px 0; text-shadow: 4px 4px 0px #000; }

        .container {
            width: 90%;
            max-width: 750px;
            background: #7a7a7a;
            border: 8px solid var(--mc-border);
            padding: 30px;
            box-shadow: inset -10px -10px 0px #4a4a4a, 0 10px 0px rgba(0,0,0,0.3);
            text-align: center;
        }

        .stats-bar { font-size: 2rem; margin-bottom: 20px; color: #ffff00; text-shadow: 2px 2px 0px #000; }

        .mc-btn {
            font-family: var(--font-main);
            font-weight: bold;
            font-size: 1.8rem;
            padding: 12px 25px;
            color: white;
            background: #666;
            border: 5px solid var(--mc-border);
            border-top-color: #aaa;
            border-left-color: #aaa;
            cursor: pointer;
            margin: 10px;
            text-shadow: 2px 2px 0px #000;
        }

        .mc-btn:active { transform: translateY(3px); border: 5px solid #fff; }
        .btn-green { background-color: var(--mc-green); }
        .btn-audio { background-color: #ff9800; width: 100%; max-width: 300px; }
        .btn-dirt { background-color: var(--mc-dirt); }

        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 20px; }
        .card { background: #bbb; border: 4px solid var(--mc-border); height: 90px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; color: #222; }
        .card.active { background: var(--mc-green); color: white; }
        .card.hidden { opacity: 0; pointer-events: none; }

        .slot { display: inline-block; width: 55px; height: 65px; background: rgba(0,0,0,0.4); border-bottom: 6px solid #ffff00; margin: 5px; font-size: 2.5rem; line-height: 65px; }

        /* Creeper Style Mascot */
        .mascot {
            width: 100px;
            height: 100px;
            background: #333;
            margin: 20px auto;
            border: 5px solid #000;
            position: relative;
            transition: background 0.3s;
        }
        .eye { width: 20px; height: 20px; background: #000; position: absolute; top: 20px; }
        .eye.left { left: 20px; } .eye.right { right: 20px; }
        .mouth { width: 40px; height: 40px; background: #000; position: absolute; bottom: 10px; left: 30px; }

        #thumb {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: 12rem; z-index: 1000;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .pop { transform: translate(-50%, -50%) scale(1.5) !important; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <h1>SOUND CRAFT!</h1>
    <div class="stats-bar">XP: <span id="xp">0</span></div>

    <div id="thumb">üëç</div>

    <div class="container">
        <div id="scr-start">
            <p style="font-size: 1.8rem;">Ready for the Woman's Voice Challenge?</p>
            <button class="mc-btn btn-green" onclick="startMatching()">START QUEST</button>
        </div>

        <div id="scr-match" class="hidden">
            <h2>Match the Sounds!</h2>
            <div class="grid" id="grid"></div>
        </div>

        <div id="scr-choose" class="hidden">
            <h2 id="choose-title">Listen Carefully</h2>
            <button class="mc-btn btn-audio" onclick="playTarget()">CLICK FOR VOICE üîä</button>
            <div id="choice-area" style="margin-top:20px;"></div>
        </div>

        <div id="scr-build" class="hidden">
            <h2 id="build-title">Craft the Word</h2>
            <button class="mc-btn btn-audio" onclick="playTarget()">CLICK FOR VOICE üîä</button>
            <div id="slots-area" style="margin: 30px 0;"></div>
            <div id="letter-bank"></div>
        </div>

        <div id="scr-win" class="hidden">
            <h2 style="color: #ffff00; font-size: 3.5rem;">QUEST COMPLETE!</h2>
            <button class="mc-btn btn-dirt" onclick="location.reload()">PLAY AGAIN</button>
        </div>

        <div class="mascot" id="mascot">
            <div class="eye left"></div>
            <div class="eye right"></div>
            <div class="mouth"></div>
        </div>
    </div>

<script>
    let xp = 0;
    let wordIdx = 0;
    let target = "";
    let guess = "";
    let femaleVoice = null;

    const wordBank = ["king", "ring", "song", "wing", "long", "duck", "back", "rock", "sick", "neck"];

    // VOICE SETUP: Find a woman's voice
    function loadVoices() {
        const voices = window.speechSynthesis.getVoices();
        // Try to find a female sounding voice
        femaleVoice = voices.find(v => 
            v.name.includes('Female') || 
            v.name.includes('Samantha') || 
            v.name.includes('Google US English') ||
            v.name.includes('Zira')
        ) || voices[0];
    }
    window.speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();

    function speak(t) {
        const m = new SpeechSynthesisUtterance(t);
        if (femaleVoice) m.voice = femaleVoice;
        m.lang = 'en-US';
        m.rate = 0.8;
        window.speechSynthesis.speak(m);
    }

    function playTarget() { speak(target); }

    function showThumb() {
        const t = document.getElementById('thumb');
        const m = document.getElementById('mascot');
        t.classList.add('pop');
        m.style.background = '#5aa730'; // Turn Mascot Green
        setTimeout(() => {
            t.classList.remove('pop');
            m.style.background = '#333';
        }, 800);
    }

    function addXP(n) {
        xp += n;
        document.getElementById('xp').innerText = xp;
    }

    // --- PHASE 1: MATCHING ---
    let firstCard = null;
    function startMatching() {
        document.getElementById('scr-start').classList.add('hidden');
        document.getElementById('scr-match').classList.remove('hidden');
        let matchWords = ["king", "duck", "ring", "rock"];
        let deck = [];
        matchWords.forEach(w => { deck.push({type:'audio', val:w}, {type:'text', val:w}); });
        deck.sort(() => Math.random() - 0.5);

        deck.forEach(card => {
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = card.type === 'audio' ? 'üîä' : card.val;
            div.onclick = () => {
                if(div.classList.contains('hidden') || div.classList.contains('active')) return;
                if(card.type === 'audio') speak(card.val);
                div.classList.add('active');
                if(!firstCard) { firstCard = {div, card}; } 
                else {
                    if(firstCard.card.val === card.val && firstCard.card.type !== card.type) {
                        showThumb(); addXP(50);
                        let d1 = firstCard.div; let d2 = div;
                        setTimeout(() => {
                            d1.classList.add('hidden'); d2.classList.add('hidden');
                            if(document.querySelectorAll('.card:not(.hidden)').length === 0) startChoice();
                        }, 500);
                        firstCard = null;
                    } else {
                        let d1 = firstCard.div; let d2 = div;
                        setTimeout(() => { d1.classList.remove('active'); d2.classList.remove('active'); }, 500);
                        firstCard = null;
                    }
                }
            };
            document.getElementById('grid').appendChild(div);
        });
    }

    // --- PHASE 2: CHOOSING ---
    function startChoice() {
        document.getElementById('scr-match').classList.add('hidden');
        document.getElementById('scr-choose').classList.remove('hidden');
        wordIdx = 0; loadChoice();
    }
    function loadChoice() {
        if(wordIdx >= 4) { startBuild(); return; }
        target = wordBank[wordIdx];
        document.getElementById('choose-title').innerText = `Level ${wordIdx+1}/4`;
        const area = document.getElementById('choice-area');
        area.innerHTML = '';
        [target, "kin", "duch"].sort(() => Math.random() - 0.5).forEach(o => {
            const b = document.createElement('button');
            b.className = 'mc-btn btn-dirt';
            b.innerText = o;
            b.onclick = () => {
                if(o === target) { showThumb(); addXP(100); wordIdx++; setTimeout(loadChoice, 900); }
                else { b.style.opacity = "0.2"; }
            }
            area.appendChild(b);
        });
    }

    // --- PHASE 3: UNSCRAMBLE ---
    function startBuild() {
        document.getElementById('scr-choose').classList.add('hidden');
        document.getElementById('scr-build').classList.remove('hidden');
        wordIdx = 0; loadBuild();
    }
    function loadBuild() {
        if(wordIdx >= wordBank.length) {
            document.getElementById('scr-build').classList.add('hidden');
            document.getElementById('scr-win').classList.remove('hidden');
            return;
        }
        target = wordBank[wordIdx];
        guess = "";
        document.getElementById('build-title').innerText = `Craft: ${wordIdx+1}/${wordBank.length}`;
        const sArea = document.getElementById('slots-area');
        const lBank = document.getElementById('letter-bank');
        sArea.innerHTML = ''; lBank.innerHTML = '';
        for(let i=0; i<target.length; i++) {
            const s = document.createElement('div');
            s.className = 'slot'; s.id = 'slot-' + i;
            sArea.appendChild(s);
        }
        target.split('').sort(() => Math.random() - 0.5).forEach(char => {
            const b = document.createElement('button');
            b.className = 'mc-btn btn-green';
            b.innerText = char;
            b.onclick = () => {
                document.getElementById('slot-' + guess.length).innerText = char;
                guess += char; b.style.visibility = 'hidden';
                if(guess.length === target.length) {
                    if(guess === target) { showThumb(); addXP(200); wordIdx++; setTimeout(loadBuild, 1000); }
                    else { setTimeout(loadBuild, 600); }
                }
            };
            lBank.appendChild(b);
        });
    }
</script>
</body>
</html>
